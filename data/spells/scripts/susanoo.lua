local combat1 = createCombatObject()
setCombatParam(combat1, COMBAT_PARAM_TARGETCASTERORTOPMOST, 1)
setCombatParam(combat1, COMBAT_PARAM_AGGRESSIVE, false)

local function onCastSpell1(parameters)
    doCombat(parameters.cid, parameters.combat1, parameters.var)
end

function perfectosusanoomadara2xx(cid)

end
function perfectosusanoomadara1xx(cid) 
if isPlayer(cid) == TRUE then       
local pos = getCreaturePosition(cid)
local posEx = {x = pos.x + 1, y = pos.y + 1, z = pos.z} 
doSendMagicEffect(posEx, 21)               
           addEvent(perfectosusanoomadara2xx,1500,cid)
     end
     end
     function perfectosusanoomadara9x(cid) 
if isPlayer(cid) == TRUE then       
local pos = getCreaturePosition(cid)
local posEx = {x = pos.x + 1, y = pos.y + 1, z = pos.z} 
doSendMagicEffect(posEx, 21)               
           addEvent(perfectosusanoomadara1xx,1500,cid)
     end
     end
     function perfectosusanoomadara8x(cid) 
if isPlayer(cid) == TRUE then       
local pos = getCreaturePosition(cid)
local posEx = {x = pos.x + 1, y = pos.y + 1, z = pos.z} 
doSendMagicEffect(posEx, 21)               
           addEvent(perfectosusanoomadara9x,1500,cid)
     end
     end
     function perfectosusanoomadara7x(cid) 
if isPlayer(cid) == TRUE then       
local pos = getCreaturePosition(cid)
local posEx = {x = pos.x + 1, y = pos.y + 1, z = pos.z} 
doSendMagicEffect(posEx, 21)               
           addEvent(perfectosusanoomadara8x,1500,cid)
     end
     end
     function perfectosusanoomadara6x(cid) 
if isPlayer(cid) == TRUE then       
local pos = getCreaturePosition(cid)
local posEx = {x = pos.x + 1, y = pos.y + 1, z = pos.z} 
doSendMagicEffect(posEx, 21)               
           addEvent(perfectosusanoomadara7x,1500,cid)
     end
     end
     function perfectosusanoomadara5x(cid) 
if isPlayer(cid) == TRUE then       
local pos = getCreaturePosition(cid)
local posEx = {x = pos.x + 1, y = pos.y + 1, z = pos.z} 
doSendMagicEffect(posEx, 21)               
           addEvent(perfectosusanoomadara6x,1500,cid)
     end
     end
     function perfectosusanoomadara4x(cid) 
if isPlayer(cid) == TRUE then       
local pos = getCreaturePosition(cid)
local posEx = {x = pos.x + 1, y = pos.y + 1, z = pos.z} 
doSendMagicEffect(posEx, 21)               
           addEvent(perfectosusanoomadara5x,1500,cid)
     end
     end
function perfectosusanoomadara3x(cid) 
if isPlayer(cid) == TRUE then       
local pos = getCreaturePosition(cid)
local posEx = {x = pos.x + 1, y = pos.y + 1, z = pos.z} 
doSendMagicEffect(posEx, 21)               
           addEvent(perfectosusanoomadara4x,1500,cid)
     end
     end
     function perfectosusanoomadara2x(cid) 
if isPlayer(cid) == TRUE then       
local pos = getCreaturePosition(cid)
local posEx = {x = pos.x + 1, y = pos.y + 1, z = pos.z} 
doSendMagicEffect(posEx, 21)               
           addEvent(perfectosusanoomadara3x,1500,cid)
     end
     end
     function perfectosusanoomadara1x(cid) 
if isPlayer(cid) == TRUE then       
local pos = getCreaturePosition(cid)
local posEx = {x = pos.x + 1, y = pos.y + 1, z = pos.z} 
doSendMagicEffect(posEx, 21)               
           addEvent(perfectosusanoomadara2x,1500,cid)
     end
     end
     function perfectosusanoomadara9(cid) 
if isPlayer(cid) == TRUE then       
local pos = getCreaturePosition(cid)
local posEx = {x = pos.x + 1, y = pos.y + 1, z = pos.z} 
doSendMagicEffect(posEx, 21)               
           addEvent(perfectosusanoomadara1x,1500,cid)
     end
     end
     function perfectosusanoomadara8(cid) 
if isPlayer(cid) == TRUE then       
local pos = getCreaturePosition(cid)
local posEx = {x = pos.x + 1, y = pos.y + 1, z = pos.z} 
doSendMagicEffect(posEx, 21)               
           addEvent(perfectosusanoomadara9,1500,cid)
     end
     end
function perfectosusanoomadara7(cid) 
if isPlayer(cid) == TRUE then       
local pos = getCreaturePosition(cid)
local posEx = {x = pos.x + 1, y = pos.y + 1, z = pos.z} 
doSendMagicEffect(posEx, 21)               
           addEvent(perfectosusanoomadara8,1500,cid)
     end
     end
     function perfectosusanoomadara6(cid) 
if isPlayer(cid) == TRUE then       
local pos = getCreaturePosition(cid)
local posEx = {x = pos.x + 1, y = pos.y + 1, z = pos.z} 
doSendMagicEffect(posEx, 21)               
           addEvent(perfectosusanoomadara7,1500,cid)
     end
     end
     function perfectosusanoomadara5(cid) 
if isPlayer(cid) == TRUE then       
local pos = getCreaturePosition(cid)
local posEx = {x = pos.x + 1, y = pos.y + 1, z = pos.z} 
doSendMagicEffect(posEx, 21)               
           addEvent(perfectosusanoomadara6,1500,cid)
     end
     end
     function perfectosusanoomadara4(cid) 
if isPlayer(cid) == TRUE then       
local pos = getCreaturePosition(cid)
local posEx = {x = pos.x + 1, y = pos.y + 1, z = pos.z} 
doSendMagicEffect(posEx, 21)               
           addEvent(perfectosusanoomadara5,1500,cid)
     end
     end
     function perfectosusanoomadara3(cid) 
if isPlayer(cid) == TRUE then       
local pos = getCreaturePosition(cid)
local posEx = {x = pos.x + 1, y = pos.y + 1, z = pos.z} 
doSendMagicEffect(posEx, 21)               
           addEvent(perfectosusanoomadara4,1500,cid)
     end
     end
     function perfectosusanoomadara2(cid) 
if isPlayer(cid) == TRUE then       
local pos = getCreaturePosition(cid)
local posEx = {x = pos.x + 1, y = pos.y + 1, z = pos.z} 
doSendMagicEffect(posEx, 21)               
           addEvent(perfectosusanoomadara3,1500,cid)
     end
     end
function perfectosusanoomadara(cid) 
if isPlayer(cid) == TRUE then       
local pos = getCreaturePosition(cid)
local posEx = {x = pos.x + 1, y = pos.y + 1, z = pos.z} 
doSendMagicEffect(posEx, 21)               
           addEvent(perfectosusanoomadara2,1500,cid)
     end
     end
     
local buff = createConditionObject(CONDITION_ATTRIBUTES)
setConditionParam(buff, CONDITION_PARAM_TICKS, 30 * 1000)
setConditionParam(buff, CONDITION_PARAM_BUFF, true)
setConditionParam(buff, CONDITION_PARAM_SKILL_SHIELD, 15)
setConditionParam(buff, CONDITION_PARAM_SKILL_FISHING, 15)
setConditionParam(buff, CONDITION_PARAM_STAT_MAGICLEVEL, 10)

setCombatCondition(combat1, buff) 


function onCastSpell(cid, var)

local parameters = { cid = cid, var = var, combat1 = combat1, combat2 = combat2, combat3 = combat3, }
	if exhaustion.check(cid, 16102) == false then
exhaustion.set(cid, 16102, 40)  

local pos = getCreaturePosition(cid)
local position = {x = pos.x + 0, y = pos.y - 0 , z = pos.z}
doSendMagicEffect(position, 109)
doCreatureAddHealth(cid, -getCreatureMaxHealth(cid)/ 3)
local pos = getCreaturePosition(cid)
local posEx = {x = pos.x + 1, y = pos.y + 1, z = pos.z} 
doSendMagicEffect(posEx, 21) 
     addEvent(perfectosusanoomadara,1500,cid)
     return doCombat(cid, combat1, var)
else
doPlayerSendCancel(cid, "Cooldown[" ..exhaustion.get(cid, 16102).."]")
end
end
